function h(a,b){return[a*b[0],a*b[1]]}function m(a,b){return[a[0]+b[0],a[1]+b[1]]}function n(a,b){return[a[0]-b[0],a[1]-b[1]]}function p(a,b){return a[0]*b[0]+a[1]*b[1]}function q(a,b){return m(h(b[0],a[0]),h(b[1],a[1]))}function r(a,b){this.a=a;this.b=b}function t(a){var b=a.a;a=a.b;return"matrix("+b[0][0]+","+b[0][1]+","+b[1][0]+","+b[1][1]+","+a[0]+","+a[1]+")"}function u(a,b){var d=a.a,l=b.a;return new r([q(d,l[0]),q(d,l[1])],m(q(a.a,b.b),a.b))}var v=new r([[1,0],[0,1]],[0,0]);
function w(a){var b={pan:!1,rotate:!0},d={};a=void 0==a?d:a;for(k in b)d=a[k],a[k]=void 0==d?b[k]:d;return a}
function z(a,b){function d(b){var c=b[0].pageX-a.offsetLeft;b=b[0].pageY-a.offsetTop;return[[c,b],[c+1,b+1]]}function l(b){var c=a.offsetLeft,d=a.offsetTop;return[[b[0].pageX-c,b[0].pageY-d],[b[1].pageX-c,b[1].pageY-d]]}this.c=a;this.b=!1;this.a=v;this.f=null;this.i=[0,0];var c=this,e=!1;this.h=w(b);a.style["transform-origin"]="0 0";a.parentNode.addEventListener("touchstart",function(a){var b=a.touches;if(!b)return!1;a.preventDefault();c.i=1<b.length?l(b):d(b);2===b.length?c.b=!0:1==b.length&&(e?
(e=c.b=!1,c.g()):(e=setTimeout(function(){e=!1},300),c.h.pan&&(c.b=!0)))});a.parentNode.addEventListener("touchmove",function(b){var a=b.touches;if(!a||!c.b)return!1;b.preventDefault();b=c.i;var a=1<a.length?l(a):d(a),f=n(b[1],b[0]),e=n(a[1],a[0]),g;if(c.h.rotate){var y=p(f,f);g=p(f,e)/y;f=(f[0]*e[1]-f[1]*e[0])/y;g=[[g,f],[-f,g]]}else g=Math.sqrt(p(e,e))/Math.sqrt(p(f,f)),g=[[g,0],[-0,g]];c.f=new r(g,n(a[0],q(g,b[0])));c.c.style.transform=t(u(c.f,c.a))});a.parentNode.addEventListener("touchend",function(){c.b&&
(c.a=u(c.f,c.a),c.b=!1)})}z.prototype.g=function(){if(window.requestAnimationFrame){var a=this.a,b=null,d=this,l=function(c){b||(b=c);c=(c-b)/100;if(1<c)d.a=v,d.b=!1,d.c.style.transform=t(d.a);else{var e=a.a,x=v.a;d.c.style.transform=t(new r([m(h(1-c,e[0]),h(c,x[0])),m(h(1-c,e[1]),h(c,x[1]))],m(h(1-c,a.b),h(c,v.b))));window.requestAnimationFrame(l)}};window.requestAnimationFrame(l)}else this.a=v,this.b=!1,this.c.style.transform=t(this.a)};z.prototype.reset=z.prototype.g;window.Zoom=z;
